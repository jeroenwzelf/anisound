<!--
 ! @name index.html for Ani-Sound
 ! @author Jeroen Donkers
 ! @fileoverview
 ! The main html file for Ani-Sound. This is where the scripts are loaded and all the content is created.
 ! It contains the page layout, some UI functionality (mostly button clicking), and it initializes the 
 ! scripts used to set up the interactive world map with its entries.
 ! -->

<!DOCTYPE>
<html>
  <head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8" />
    <link rel="shortcut icon" type="image/png" href="images/logo/logo_medium.png">
    <title>Ani-Sound</title>

    <style type="text/css">
      body {
      	position: relative;
		width: 100%;
		height: 100%;
        margin: 0;
        font-family: Arial;
        font-size: 16px;
      }

      #map {
		width: 100%;
		height: calc(100% - 70px);
      }
    </style>
    <!-- Google Maps API, JQuery and Bootstrap -->
    <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhjEZgjkFvvD2Yvf099m5qtvipcm79ays&callback=initialize"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	<!-- Load an icon library to show a hamburger menu (bars) on small screens -->
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
	<!-- anisound scripts -->
    <script type="text/javascript" src="js/filtergenera.json"></script>
    <script type="text/javascript" src="js/markerclusterer.js"></script>
    <script type="text/javascript" src="js/entrymanager.js"></script>
    <script type="text/javascript" src="js/styledMap.js"></script>
	<link rel="stylesheet" type="text/css" href="cs/style.css">

    <script type="text/javascript">
		function init() {
			init_map(getStyledMap());
			getInnerHtmlFilterList();
		}
    </script>
</head>
<body>
	<img id="birds" src="images/markers/animals/birds.png" style="display:none" crossOrigin="Anonymous" onload="init()">
	<!-- Sidebar -->
	<div class="w3-sidebar w3-bar-block filter_closed" id="speciesfilter">
		<button id="closeSpeciesFilterButton" class="w3-bar-item w3-button w3-large">Close &times;</button>
		<div id=genuslist> </div>
		<button style="position: absolute; bottom: 20; padding: 10px" id="deselectAllButton" class="w3-bar-item w3-button w3-large">Deslect All</button>
		<button style="position: absolute; bottom: 70; padding: 10px" id="selectAllButton" class="w3-bar-item w3-button w3-large">Select All</button>
	</div>
	<!-- Top Navigation Bar -->
	<div class="topnav" id="myTopnav">
		<!-- Genus Filter -->
		<a id="openSpeciesFilterButton" href="javascript:void(0);" class="icon">
			<i class="fa fa-bars"></i>
			<span class="HideOnSmallWidth" style="">Genus filter</span>
		</a>
		<div style="flex: auto;">
		</div>
		<!-- Search Bar -->
		<a id="clearSearchIcon" data-toggle="tooltip" data-placement="bottom" title="Clears the search bar." style="background-color: #333 !important;" href="javascript:void(0)">
			<span class="HideOnMicroWidth">&times;</span>
		</a>
		<input class="HideOnMicroWidth" style="height: 40px; width: 190px; display: block;" type="text" id="searchbar" placeholder="Search.." title="Type in a name">
		<!-- About Popup Button -->
		<a id="openAboutButton" data-toggle="tooltip" data-placement="bottom" title="About Ani-Sound." style="float: right;" href="javascript:void(0)">
			<img src="images/logo/logo_medium_border.png" height="48">
		</a>
	</div>
	<!-- Google Map -->
	<div id="map"></div>
	<!-- Query Loading Spinner -->
	<div id="loader" class="loader HideOnMicroHeight" style="display: none" data-toggle="tooltip" data-placement="bottom"></div> 
	<!-- About Popup -->
	<div id="popUp" class="popUpClosed">
	    <div id="close" class="close"><i class="fa fa-times"></i></div>
	    <div id="new"><span>ABOUT</span></div>
	    <h2><strong>Ani-Sound</strong> is a <a title="Leiden University Website" href="https://www.universiteitleiden.nl/en"><em>Leiden University</em></a> project that Interactive Information Displays. This application visualizes animal data from the online database <a title="Xeno-canto Website" href="https://www.xeno-canto.org/about/xeno-canto"><em>Xeno-canto</em></a> in a topographical way.<br/><br/></h2>
	    <h2 style="font-size: 11px !important; margin-top: 10px !important;">This project has been written in <em>HTML+JavaScript</em> and is available as open-source software on its GitHub page.</h2><br>
	    <div style="display: flex; flex-flow: row; padding: 5px;">
	  		<p style="margin: -6px 0 0 10px; color: silver; font-size: 12px;">Arianna Freni </br> Jeroen Donkers</p>
	  		<div style="flex: auto"></div>
	  		<p style="margin: -6px 0 0 10px; color: silver; font-size: 12px;"></br>Ani-Sound: v3.0.1</p>
	  	</div>
	    <a href="https://github.com/jeroenwzelf/anisound" target="_blank" class="aboutbutton">Visit Page</a>
  	</div>
	</body>

	<!-- Opening and closing windows (genus filter, about popup) -->
	<script type="text/javascript">
		$("#clearSearchIcon").click(function(e) {
			var searchbar = document.getElementById("searchbar");
			searchbar.value = '';
			markerCluster.filterOnString();
		});

		$("#searchbar").keyup(function(e) {
		    markerCluster.filterOnString();
		    $("#popUp").addClass("popUpClosed");
		    $('#speciesfilter').addClass('filter_closed');
			$('#speciesfilter').removeClass('filter_open');
		    e.stopPropagation();
		});

		$("#searchbar").click(function(e) {
			$("#popUp").addClass("popUpClosed");
		    $('#speciesfilter').addClass('filter_closed');
			$('#speciesfilter').removeClass('filter_open');
		    e.stopPropagation();
		});

		$("#deselectAllButton").click(function(e) {
			for (var i = 0; i < filtergenera.genera.length; i++)
				document.getElementById(getCheckBoxId(filtergenera.genera[i].name)).checked = false;
			e.stopPropagation();
		});

		$("#selectAllButton").click(function(e) {
			for (var i = 0; i < filtergenera.genera.length; i++)
				document.getElementById(getCheckBoxId(filtergenera.genera[i].name)).checked = true;
			e.stopPropagation();
		});

		$("#openAboutButton").click(function(e) {
			$("#popUp").removeClass("popUpClosed");
			e.stopPropagation();
		});

		$("#close").click(function(e) {
			$("#popUp").addClass("popUpClosed");
		});

		$('#openSpeciesFilterButton').click(function(e) {
			e.stopPropagation();
			$('#speciesfilter').removeClass('filter_closed');
			$('#speciesfilter').addClass('filter_open');
		});

		$('#closeSpeciesFilterButton').click(function(e) {
			$('#speciesfilter').addClass('filter_closed');
			$('#speciesfilter').removeClass('filter_open');
		});

		$('#speciesfilter').click(function(e) {
			e.stopPropagation();
		});

		$("#popUp").click(function(e) {
			e.stopPropagation();
		});

		$(document).click(function(e) {
			$(':focus').blur();
			$('#speciesfilter').addClass('filter_closed');
			$('#speciesfilter').removeClass('filter_open');
			$("#popUp").addClass("popUpClosed");
		});
	</script>
</html>